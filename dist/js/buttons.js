"use strict";var _createClass=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,n,o)}if("value"in i)return i.value;var r=i.get;return void 0!==r?r.call(o):void 0};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}!function(a,i){var e={direction:"top",hoverEnabled:!0,toolbarEnabled:!1};a.fn.reverse=[].reverse;var t=function(t){function o(t,e){_classCallCheck(this,o);var n=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,o,t,e));return(n.el.M_FloatingActionButton=n).options=a.extend({},o.defaults,e),n.isOpen=!1,n.$anchor=n.$el.children("a").first(),n.$menu=n.$el.children("ul").first(),n.$floatingBtns=n.$el.find("ul .btn-floating"),n.$floatingBtnsReverse=n.$el.find("ul .btn-floating").reverse(),n.offsetY=0,n.offsetX=0,"top"===n.options.direction?(n.$el.addClass("direction-top"),n.offsetY=40):"right"===n.options.direction?(n.$el.addClass("direction-right"),n.offsetX=-40):"bottom"===n.options.direction?(n.$el.addClass("direction-bottom"),n.offsetY=-40):(n.$el.addClass("direction-left"),n.offsetX=40),n._setupEventHandlers(),n}return _inherits(o,Component),_createClass(o,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_FloatingActionButton=void 0}},{key:"_setupEventHandlers",value:function(){this._handleFABClickBound=this._handleFABClick.bind(this),this._handleOpenBound=this.open.bind(this),this._handleCloseBound=this.close.bind(this),this.options.hoverEnabled&&!this.options.toolbarEnabled?(this.el.addEventListener("mouseenter",this._handleOpenBound),this.el.addEventListener("mouseleave",this._handleCloseBound)):this.el.addEventListener("click",this._handleFABClickBound)}},{key:"_removeEventHandlers",value:function(){this.options.hoverEnabled&&!this.options.toolbarEnabled?(this.el.removeEventListener("mouseenter",this._handleOpenBound),this.el.removeEventListener("mouseleave",this._handleCloseBound)):this.el.removeEventListener("click",this._handleFABClickBound)}},{key:"_handleFABClick",value:function(){this.isOpen?this.close():this.open()}},{key:"_handleDocumentClick",value:function(t){a(t.target).closest(this.$menu).length||this.close()}},{key:"open",value:function(){this.isOpen||(this.options.toolbarEnabled?this._animateInToolbar():this._animateInFAB(),this.isOpen=!0)}},{key:"close",value:function(){this.isOpen&&(this.options.toolbarEnabled?(window.removeEventListener("scroll",this._handleCloseBound,!0),document.body.removeEventListener("click",this._handleDocumentClickBound,!0),this._animateOutToolbar()):this._animateOutFAB(),this.isOpen=!1)}},{key:"_animateInFAB",value:function(){var e=this;this.$el.addClass("active");var n=0;this.$floatingBtnsReverse.each(function(t){i({targets:t,opacity:1,scale:[.4,1],translateY:[e.offsetY,0],translateX:[e.offsetX,0],duration:275,delay:n,easing:"easeInOutQuad"}),n+=40})}},{key:"_animateOutFAB",value:function(){var e=this;this.$floatingBtnsReverse.each(function(t){i.remove(t),i({targets:t,opacity:0,scale:.4,translateY:e.offsetY,translateX:e.offsetX,duration:175,easing:"easeOutQuad",complete:function(){e.$el.removeClass("active")}})})}},{key:"_animateInToolbar",value:function(){var t,e=this,n=window.innerWidth,o=window.innerHeight,i=this.el.getBoundingClientRect(),s=a('<div class="fab-backdrop"></div>'),r=this.$anchor.css("background-color");this.$anchor.append(s),this.offsetX=i.left-n/2+i.width/2,this.offsetY=o-i.bottom,t=n/s[0].clientWidth,this.btnBottom=i.bottom,this.btnLeft=i.left,this.btnWidth=i.width,this.$el.addClass("active"),this.$el.css({"text-align":"center",width:"100%",bottom:0,left:0,transform:"translateX("+this.offsetX+"px)",transition:"none"}),this.$anchor.css({transform:"translateY("+-this.offsetY+"px)",transition:"none"}),s.css({"background-color":r}),setTimeout(function(){e.$el.css({transform:"",transition:"transform .2s cubic-bezier(0.550, 0.085, 0.680, 0.530), background-color 0s linear .2s"}),e.$anchor.css({overflow:"visible",transform:"",transition:"transform .2s"}),setTimeout(function(){e.$el.css({overflow:"hidden","background-color":r}),s.css({transform:"scale("+t+")",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"}),e.$menu.children("li").children("a").css({opacity:1}),e._handleDocumentClickBound=e._handleDocumentClick.bind(e),window.addEventListener("scroll",e._handleCloseBound,!0),document.body.addEventListener("click",e._handleDocumentClickBound,!0)},100)},0)}},{key:"_animateOutToolbar",value:function(){var t=this,e=window.innerWidth,n=window.innerHeight,o=this.$el.find(".fab-backdrop"),i=this.$anchor.css("background-color");this.offsetX=this.btnLeft-e/2+this.btnWidth/2,this.offsetY=n-this.btnBottom,this.$el.removeClass("active"),this.$el.css({"background-color":"transparent",transition:"none"}),this.$anchor.css({transition:"none"}),o.css({transform:"scale(0)","background-color":i}),this.$menu.children("li").children("a").css({opacity:""}),setTimeout(function(){o.remove(),t.$el.css({"text-align":"",width:"",bottom:"",left:"",overflow:"","background-color":"",transform:"translate3d("+-t.offsetX+"px,0,0)"}),t.$anchor.css({overflow:"",transform:"translate3d(0,"+t.offsetY+"px,0)"}),setTimeout(function(){t.$el.css({transform:"translate3d(0,0,0)",transition:"transform .2s"}),t.$anchor.css({transform:"translate3d(0,0,0)",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"})},20)},200)}}],[{key:"init",value:function(t,e){return _get(o.__proto__||Object.getPrototypeOf(o),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_FloatingActionButton}},{key:"defaults",get:function(){return e}}]),o}();M.FloatingActionButton=t,M.jQueryLoaded&&M.initializeJqueryWrapper(t,"floatingActionButton","M_FloatingActionButton")}(cash,M.anime);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1dHRvbnMuanMiXSwibmFtZXMiOlsiJCIsImFuaW0iLCJfZGVmYXVsdHMiLCJkaXJlY3Rpb24iLCJob3ZlckVuYWJsZWQiLCJ0b29sYmFyRW5hYmxlZCIsImZuIiwicmV2ZXJzZSIsIl9Db21wb25lbnQiLCJGbG9hdGluZ0FjdGlvbkJ1dHRvbiIsImVsIiwib3B0aW9ucyIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfdGhpcyIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiX19wcm90b19fIiwiT2JqZWN0IiwiZ2V0UHJvdG90eXBlT2YiLCJjYWxsIiwiTV9GbG9hdGluZ0FjdGlvbkJ1dHRvbiIsImV4dGVuZCIsImRlZmF1bHRzIiwiaXNPcGVuIiwiJGFuY2hvciIsIiRlbCIsImNoaWxkcmVuIiwiJG1lbnUiLCJmaXJzdCIsIiRmbG9hdGluZ0J0bnMiLCJmaW5kIiwiJGZsb2F0aW5nQnRuc1JldmVyc2UiLCJvZmZzZXRZIiwib2Zmc2V0WCIsImFkZENsYXNzIiwiX3NldHVwRXZlbnRIYW5kbGVycyIsIl9pbmhlcml0cyIsIkNvbXBvbmVudCIsIl9jcmVhdGVDbGFzcyIsImtleSIsInZhbHVlIiwiX3JlbW92ZUV2ZW50SGFuZGxlcnMiLCJ1bmRlZmluZWQiLCJfaGFuZGxlRkFCQ2xpY2tCb3VuZCIsIl9oYW5kbGVGQUJDbGljayIsImJpbmQiLCJfaGFuZGxlT3BlbkJvdW5kIiwib3BlbiIsIl9oYW5kbGVDbG9zZUJvdW5kIiwiY2xvc2UiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJjbG9zZXN0IiwibGVuZ3RoIiwiX2FuaW1hdGVJblRvb2xiYXIiLCJfYW5pbWF0ZUluRkFCIiwid2luZG93IiwiZG9jdW1lbnQiLCJfaGFuZGxlRG9jdW1lbnRDbGlja0JvdW5kIiwiX2FuaW1hdGVPdXRUb29sYmFyIiwiX2FuaW1hdGVPdXRGQUIiLCJfdGhpczIiLCJ0aW1lIiwiZWFjaCIsInRhcmdldHMiLCJvcGFjaXR5Iiwic2NhbGUiLCJib2R5IiwiZHVyYXRpb24iLCJkZWxheSIsImVhc2luZyIsIl90aGlzMyIsInJlbW92ZSIsInRyYW5zbGF0ZVkiLCJ0cmFuc2xhdGVYIiwicmVtb3ZlQ2xhc3MiLCJzY2FsZUZhY3RvciIsIl90aGlzNCIsIndpbmRvd1dpZHRoIiwiaW5uZXJXaWR0aCIsIndpbmRvd0hlaWdodCIsImlubmVySGVpZ2h0IiwiYnRuUmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImJhY2tkcm9wIiwiZmFiQ29sb3IiLCJjc3MiLCJhcHBlbmQiLCJsZWZ0Iiwid2lkdGgiLCJib3R0b20iLCJjbGllbnRXaWR0aCIsImNvbXBsZXRlIiwidHJhbnNmb3JtIiwidHJhbnNpdGlvbiIsImJhY2tncm91bmQtY29sb3IiLCJzZXRUaW1lb3V0Iiwib3ZlcmZsb3ciLCJfaGFuZGxlRG9jdW1lbnRDbGljayIsIl90aGlzNSIsImJ0bkxlZnQiLCJidG5XaWR0aCIsImJ0bkJvdHRvbSIsInRleHQtYWxpZ24iLCJlbHMiLCJfZ2V0IiwianF1ZXJ5IiwiZ2V0IiwiTSIsImpRdWVyeUxvYWRlZCIsImluaXRpYWxpemVKcXVlcnlXcmFwcGVyIiwiY2FzaCIsImFuaW1lIl0sIm1hcHBpbmdzIjoiNG5DQUFDLFNBQVVBLEVBQUdDLEdBR1osSUFBSUMsRUFBWSxDQUNkQyxVQUFXLE1BQ1hDLGNBQWMsRUFDZEMsZ0JBQWdCLEdBR2xCTCxFQUFFTSxHQUFHQyxRQUFVLEdBQUdBLFFBVEEsSUFHZEwsRUFIYyxTQUFBTSxHQXNCaEIsU0FBQUMsRUFBWUMsRUFBSUMsR0FBU0MsZ0JBQUFDLEtBQUFKLEdBQUEsSUFBQUssRUFBQUMsMkJBQUFGLE1BQUFKLEVBQUFPLFdBQUFDLE9BQUFDLGVBQUFULElBQUFVLEtBQUFOLEtBWDNCSixFQUFBQyxFQUFBQyxJQVcyQixPQUd2QkcsRUFBS0osR0FBR1UsdUJBQVJOLEdBU0tILFFBQVVYLEVBQUVxQixPQUFPLEdBQUlaLEVBQXFCYSxTQUFVWCxHQUUzREcsRUFBS1MsUUFB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IihmdW5jdGlvbiAoJCwgYW5pbSkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgbGV0IF9kZWZhdWx0cyA9IHtcbiAgICBkaXJlY3Rpb246ICd0b3AnLFxuICAgIGhvdmVyRW5hYmxlZDogdHJ1ZSxcbiAgICB0b29sYmFyRW5hYmxlZDogZmFsc2VcbiAgfTtcblxuICAkLmZuLnJldmVyc2UgPSBbXS5yZXZlcnNlO1xuXG4gIC8qKlxuICAgKiBAY2xhc3NcbiAgICpcbiAgICovXG4gIGNsYXNzIEZsb2F0aW5nQWN0aW9uQnV0dG9uIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3QgRmxvYXRpbmdBY3Rpb25CdXR0b24gaW5zdGFuY2VcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihlbCwgb3B0aW9ucykge1xuICAgICAgc3VwZXIoRmxvYXRpbmdBY3Rpb25CdXR0b24sIGVsLCBvcHRpb25zKTtcblxuICAgICAgdGhpcy5lbC5NX0Zsb2F0aW5nQWN0aW9uQnV0dG9uID0gdGhpcztcblxuICAgICAgLyoqXG4gICAgICAgKiBPcHRpb25zIGZvciB0aGUgZmFiXG4gICAgICAgKiBAbWVtYmVyIEZsb2F0aW5nQWN0aW9uQnV0dG9uI29wdGlvbnNcbiAgICAgICAqIEBwcm9wIHtCb29sZWFufSBbZGlyZWN0aW9uXSAtIERpcmVjdGlvbiBmYWIgbWVudSBvcGVuc1xuICAgICAgICogQHByb3Age0Jvb2xlYW59IFtob3ZlckVuYWJsZWQ9dHJ1ZV0gLSBFbmFibGUgaG92ZXIgdnMgY2xpY2tcbiAgICAgICAqIEBwcm9wIHtCb29sZWFufSBbdG9vbGJhckVuYWJsZWQ9ZmFsc2VdIC0gRW5hYmxlIHRvb2xiYXIgdHJhbnNpdGlvblxuICAgICAgICovXG4gICAgICB0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgRmxvYXRpbmdBY3Rpb25CdXR0b24uZGVmYXVsdHMsIG9wdGlvbnMpO1xuXG4gICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuICAgICAgdGhpcy4kYW5jaG9yID0gdGhpcy4kZWwuY2hpbGRyZW4oJ2EnKS5maXJzdCgpO1xuICAgICAgdGhpcy4kbWVudSA9IHRoaXMuJGVsLmNoaWxkcmVuKCd1bCcpLmZpcnN0KCk7XG4gICAgICB0aGlzLiRmbG9hdGluZ0J0bnMgPSB0aGlzLiRlbC5maW5kKCd1bCAuYnRuLWZsb2F0aW5nJyk7XG4gICAgICB0aGlzLiRmbG9hdGluZ0J0bnNSZXZlcnNlID0gdGhpcy4kZWwuZmluZCgndWwgLmJ0bi1mbG9hdGluZycpLnJldmVyc2UoKTtcbiAgICAgIHRoaXMub2Zmc2V0WSA9IDA7XG4gICAgICB0aGlzLm9mZnNldFggPSAwO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXJlY3Rpb24gPT09ICd0b3AnKSB7XG4gICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKCdkaXJlY3Rpb24tdG9wJyk7XG4gICAgICAgIHRoaXMub2Zmc2V0WSA9IDQwO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuZGlyZWN0aW9uID09PSAncmlnaHQnKSB7XG4gICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKCdkaXJlY3Rpb24tcmlnaHQnKTtcbiAgICAgICAgdGhpcy5vZmZzZXRYID0gLTQwO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuZGlyZWN0aW9uID09PSAnYm90dG9tJykge1xuICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcygnZGlyZWN0aW9uLWJvdHRvbScpO1xuICAgICAgICB0aGlzLm9mZnNldFkgPSAtNDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcygnZGlyZWN0aW9uLWxlZnQnKTtcbiAgICAgICAgdGhpcy5vZmZzZXRYID0gNDA7XG4gICAgICB9XG4gICAgICB0aGlzLl9zZXR1cEV2ZW50SGFuZGxlcnMoKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRzKCkge1xuICAgICAgcmV0dXJuIF9kZWZhdWx0cztcbiAgICB9XG5cbiAgICBzdGF0aWMgaW5pdChlbHMsIG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiBzdXBlci5pbml0KHRoaXMsIGVscywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IEluc3RhbmNlXG4gICAgICovXG4gICAgc3RhdGljIGdldEluc3RhbmNlKGVsKSB7XG4gICAgICBsZXQgZG9tRWxlbSA9ICEhZWwuanF1ZXJ5ID8gZWxbMF0gOiBlbDtcbiAgICAgIHJldHVybiBkb21FbGVtLk1fRmxvYXRpbmdBY3Rpb25CdXR0b247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVhcmRvd24gY29tcG9uZW50XG4gICAgICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50SGFuZGxlcnMoKTtcbiAgICAgIHRoaXMuZWwuTV9GbG9hdGluZ0FjdGlvbkJ1dHRvbiA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR1cCBFdmVudCBIYW5kbGVyc1xuICAgICAqL1xuICAgIF9zZXR1cEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgICB0aGlzLl9oYW5kbGVGQUJDbGlja0JvdW5kID0gdGhpcy5faGFuZGxlRkFCQ2xpY2suYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuX2hhbmRsZU9wZW5Cb3VuZCA9IHRoaXMub3Blbi5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5faGFuZGxlQ2xvc2VCb3VuZCA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5ob3ZlckVuYWJsZWQgJiYgIXRoaXMub3B0aW9ucy50b29sYmFyRW5hYmxlZCkge1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLl9oYW5kbGVPcGVuQm91bmQpO1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLl9oYW5kbGVDbG9zZUJvdW5kKTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUZBQkNsaWNrQm91bmQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBFdmVudCBIYW5kbGVyc1xuICAgICAqL1xuICAgIF9yZW1vdmVFdmVudEhhbmRsZXJzKCkge1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5ob3ZlckVuYWJsZWQgJiYgIXRoaXMub3B0aW9ucy50b29sYmFyRW5hYmxlZCkge1xuICAgICAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLl9oYW5kbGVPcGVuQm91bmQpO1xuICAgICAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLl9oYW5kbGVDbG9zZUJvdW5kKTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUZBQkNsaWNrQm91bmQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBGQUIgQ2xpY2tcbiAgICAgKi9cbiAgICBfaGFuZGxlRkFCQ2xpY2soKSB7XG4gICAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgRG9jdW1lbnQgQ2xpY2tcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgX2hhbmRsZURvY3VtZW50Q2xpY2soZSkge1xuICAgICAgaWYgKCEkKGUudGFyZ2V0KS5jbG9zZXN0KHRoaXMuJG1lbnUpLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbiBGQUJcbiAgICAgKi9cbiAgICBvcGVuKCkge1xuICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy50b29sYmFyRW5hYmxlZCkge1xuICAgICAgICB0aGlzLl9hbmltYXRlSW5Ub29sYmFyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9hbmltYXRlSW5GQUIoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbG9zZSBGQUJcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgIGlmICghdGhpcy5pc09wZW4pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnRvb2xiYXJFbmFibGVkKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLl9oYW5kbGVDbG9zZUJvdW5kLCB0cnVlKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZURvY3VtZW50Q2xpY2tCb3VuZCwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuX2FuaW1hdGVPdXRUb29sYmFyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9hbmltYXRlT3V0RkFCKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsYXNzaWMgRkFCIE1lbnUgb3BlblxuICAgICAqL1xuICAgIF9hbmltYXRlSW5GQUIoKSB7XG4gICAgICB0aGlzLiRlbC5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgIGxldCB0aW1lID0gMDtcbiAgICAgIHRoaXMuJGZsb2F0aW5nQnRuc1JldmVyc2UuZWFjaCgoZWwpID0+IHtcbiAgICAgICAgYW5pbSh7XG4gICAgICAgICAgdGFyZ2V0czogZWwsXG4gICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICBzY2FsZTogWy40LCAxXSxcbiAgICAgICAgICB0cmFuc2xhdGVZOiBbdGhpcy5vZmZzZXRZLCAwXSxcbiAgICAgICAgICB0cmFuc2xhdGVYOiBbdGhpcy5vZmZzZXRYLCAwXSxcbiAgICAgICAgICBkdXJhdGlvbjogMjc1LFxuICAgICAgICAgIGRlbGF5OiB0aW1lLFxuICAgICAgICAgIGVhc2luZzogJ2Vhc2VJbk91dFF1YWQnXG4gICAgICAgIH0pO1xuICAgICAgICB0aW1lICs9IDQwO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xhc3NpYyBGQUIgTWVudSBjbG9zZVxuICAgICAqL1xuICAgIF9hbmltYXRlT3V0RkFCKCkge1xuICAgICAgdGhpcy4kZmxvYXRpbmdCdG5zUmV2ZXJzZS5lYWNoKChlbCkgPT4ge1xuICAgICAgICBhbmltLnJlbW92ZShlbCk7XG4gICAgICAgIGFuaW0oe1xuICAgICAgICAgIHRhcmdldHM6IGVsLFxuICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgc2NhbGU6IC40LFxuICAgICAgICAgIHRyYW5zbGF0ZVk6IHRoaXMub2Zmc2V0WSxcbiAgICAgICAgICB0cmFuc2xhdGVYOiB0aGlzLm9mZnNldFgsXG4gICAgICAgICAgZHVyYXRpb246IDE3NSxcbiAgICAgICAgICBlYXNpbmc6ICdlYXNlT3V0UXVhZCcsXG4gICAgICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuJGVsLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVG9vbGJhciB0cmFuc2l0aW9uIE1lbnUgb3BlblxuICAgICAqL1xuICAgIF9hbmltYXRlSW5Ub29sYmFyKCkge1xuICAgICAgbGV0IHNjYWxlRmFjdG9yO1xuICAgICAgbGV0IHdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICBsZXQgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgbGV0IGJ0blJlY3QgPSB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgbGV0IGJhY2tkcm9wID0gJCgnPGRpdiBjbGFzcz1cImZhYi1iYWNrZHJvcFwiPjwvZGl2PicpO1xuICAgICAgbGV0IGZhYkNvbG9yID0gdGhpcy4kYW5jaG9yLmNzcygnYmFja2dyb3VuZC1jb2xvcicpO1xuICAgICAgdGhpcy4kYW5jaG9yLmFwcGVuZChiYWNrZHJvcCk7XG5cbiAgICAgIHRoaXMub2Zmc2V0WCA9IGJ0blJlY3QubGVmdCAtICh3aW5kb3dXaWR0aCAvIDIpICsgKGJ0blJlY3Qud2lkdGggLyAyKTtcbiAgICAgIHRoaXMub2Zmc2V0WSA9IHdpbmRvd0hlaWdodCAtIGJ0blJlY3QuYm90dG9tO1xuICAgICAgc2NhbGVGYWN0b3IgPSB3aW5kb3dXaWR0aCAvIGJhY2tkcm9wWzBdLmNsaWVudFdpZHRoO1xuICAgICAgdGhpcy5idG5Cb3R0b20gPSBidG5SZWN0LmJvdHRvbTtcbiAgICAgIHRoaXMuYnRuTGVmdCA9IGJ0blJlY3QubGVmdDtcbiAgICAgIHRoaXMuYnRuV2lkdGggPSBidG5SZWN0LndpZHRoO1xuXG4gICAgICAvLyBTZXQgaW5pdGlhbCBzdGF0ZVxuICAgICAgdGhpcy4kZWwuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgdGhpcy4kZWwuY3NzKHtcbiAgICAgICAgJ3RleHQtYWxpZ24nOiAnY2VudGVyJyxcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgYm90dG9tOiAwLFxuICAgICAgICBsZWZ0OiAwLFxuICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVYKCcgKyB0aGlzLm9mZnNldFggKyAncHgpJyxcbiAgICAgICAgdHJhbnNpdGlvbjogJ25vbmUnXG4gICAgICB9KTtcbiAgICAgIHRoaXMuJGFuY2hvci5jc3Moe1xuICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKCcgKyAtdGhpcy5vZmZzZXRZICsgJ3B4KScsXG4gICAgICAgIHRyYW5zaXRpb246ICdub25lJ1xuICAgICAgfSk7XG4gICAgICBiYWNrZHJvcC5jc3Moe1xuICAgICAgICAnYmFja2dyb3VuZC1jb2xvcic6IGZhYkNvbG9yXG4gICAgICB9KTtcblxuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy4kZWwuY3NzKHtcbiAgICAgICAgICB0cmFuc2Zvcm06ICcnLFxuICAgICAgICAgIHRyYW5zaXRpb246ICd0cmFuc2Zvcm0gLjJzIGN1YmljLWJlemllcigwLjU1MCwgMC4wODUsIDAuNjgwLCAwLjUzMCksIGJhY2tncm91bmQtY29sb3IgMHMgbGluZWFyIC4ycydcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuJGFuY2hvci5jc3Moe1xuICAgICAgICAgIG92ZXJmbG93OiAndmlzaWJsZScsXG4gICAgICAgICAgdHJhbnNmb3JtOiAnJyxcbiAgICAgICAgICB0cmFuc2l0aW9uOiAndHJhbnNmb3JtIC4ycydcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy4kZWwuY3NzKHtcbiAgICAgICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJzogZmFiQ29sb3JcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBiYWNrZHJvcC5jc3Moe1xuICAgICAgICAgICAgdHJhbnNmb3JtOiAnc2NhbGUoJyArIHNjYWxlRmFjdG9yICsgJyknLFxuICAgICAgICAgICAgdHJhbnNpdGlvbjogJ3RyYW5zZm9ybSAuMnMgY3ViaWMtYmV6aWVyKDAuNTUwLCAwLjA1NSwgMC42NzUsIDAuMTkwKSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLiRtZW51LmNoaWxkcmVuKCdsaScpLmNoaWxkcmVuKCdhJykuY3NzKHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDFcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFNjcm9sbCB0byBjbG9zZS5cbiAgICAgICAgICB0aGlzLl9oYW5kbGVEb2N1bWVudENsaWNrQm91bmQgPSB0aGlzLl9oYW5kbGVEb2N1bWVudENsaWNrLmJpbmQodGhpcyk7XG4gICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuX2hhbmRsZUNsb3NlQm91bmQsIHRydWUpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVEb2N1bWVudENsaWNrQm91bmQsIHRydWUpO1xuICAgICAgICB9LCAxMDApO1xuICAgICAgfSwgMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVG9vbGJhciB0cmFuc2l0aW9uIE1lbnUgY2xvc2VcbiAgICAgKi9cbiAgICBfYW5pbWF0ZU91dFRvb2xiYXIoKSB7XG4gICAgICBsZXQgd2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgIGxldCB3aW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICBsZXQgYmFja2Ryb3AgPSB0aGlzLiRlbC5maW5kKCcuZmFiLWJhY2tkcm9wJyk7XG4gICAgICBsZXQgZmFiQ29sb3IgPSB0aGlzLiRhbmNob3IuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJyk7XG5cbiAgICAgIHRoaXMub2Zmc2V0WCA9IHRoaXMuYnRuTGVmdCAtICh3aW5kb3dXaWR0aCAvIDIpICsgKHRoaXMuYnRuV2lkdGggLyAyKTtcbiAgICAgIHRoaXMub2Zmc2V0WSA9IHdpbmRvd0hlaWdodCAtIHRoaXMuYnRuQm90dG9tO1xuXG4gICAgICAvLyBIaWRlIGJhY2tkcm9wXG4gICAgICB0aGlzLiRlbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICB0aGlzLiRlbC5jc3Moe1xuICAgICAgICAnYmFja2dyb3VuZC1jb2xvcic6ICd0cmFuc3BhcmVudCcsXG4gICAgICAgIHRyYW5zaXRpb246ICdub25lJ1xuICAgICAgfSk7XG4gICAgICB0aGlzLiRhbmNob3IuY3NzKHtcbiAgICAgICAgdHJhbnNpdGlvbjogJ25vbmUnXG4gICAgICB9KTtcbiAgICAgIGJhY2tkcm9wLmNzcyh7XG4gICAgICAgIHRyYW5zZm9ybTogJ3NjYWxlKDApJyxcbiAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiBmYWJDb2xvclxuICAgICAgfSk7XG4gICAgICB0aGlzLiRtZW51LmNoaWxkcmVuKCdsaScpLmNoaWxkcmVuKCdhJykuY3NzKHtcbiAgICAgICAgb3BhY2l0eTogJydcbiAgICAgIH0pO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgYmFja2Ryb3AucmVtb3ZlKCk7XG5cbiAgICAgICAgLy8gU2V0IGluaXRpYWwgc3RhdGUuXG4gICAgICAgIHRoaXMuJGVsLmNzcyh7XG4gICAgICAgICAgJ3RleHQtYWxpZ24nOiAnJyxcbiAgICAgICAgICB3aWR0aDogJycsXG4gICAgICAgICAgYm90dG9tOiAnJyxcbiAgICAgICAgICBsZWZ0OiAnJyxcbiAgICAgICAgICBvdmVyZmxvdzogJycsXG4gICAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiAnJyxcbiAgICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGUzZCgnICsgLXRoaXMub2Zmc2V0WCArICdweCwwLDApJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy4kYW5jaG9yLmNzcyh7XG4gICAgICAgICAgb3ZlcmZsb3c6ICcnLFxuICAgICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZTNkKDAsJyArIHRoaXMub2Zmc2V0WSArICdweCwwKSdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy4kZWwuY3NzKHtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZTNkKDAsMCwwKScsXG4gICAgICAgICAgICB0cmFuc2l0aW9uOiAndHJhbnNmb3JtIC4ycydcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLiRhbmNob3IuY3NzKHtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZTNkKDAsMCwwKScsXG4gICAgICAgICAgICB0cmFuc2l0aW9uOiAndHJhbnNmb3JtIC4ycyBjdWJpYy1iZXppZXIoMC41NTAsIDAuMDU1LCAwLjY3NSwgMC4xOTApJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LCAyMCk7XG4gICAgICB9LCAyMDApO1xuICAgIH1cbiAgfVxuXG4gIE0uRmxvYXRpbmdBY3Rpb25CdXR0b24gPSBGbG9hdGluZ0FjdGlvbkJ1dHRvbjtcblxuICBpZiAoTS5qUXVlcnlMb2FkZWQpIHtcbiAgICBNLmluaXRpYWxpemVKcXVlcnlXcmFwcGVyKEZsb2F0aW5nQWN0aW9uQnV0dG9uLCAnZmxvYXRpbmdBY3Rpb25CdXR0b24nLCAnTV9GbG9hdGluZ0FjdGlvbkJ1dHRvbicpO1xuICB9XG5cbn0oY2FzaCwgTS5hbmltZSkpO1xuIl19
