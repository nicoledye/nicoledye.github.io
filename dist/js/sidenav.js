"use strict";var _createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),_get=function e(t,i,n){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,n)}if("value"in s)return s.value;var o=s.get;return void 0!==o?o.call(n):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(s,a){var t={edge:"left",draggable:!0,inDuration:250,outDuration:200,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,preventScrolling:!0},e=function(e){function n(e,t){_classCallCheck(this,n);var i=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,n,e,t));return(i.el.M_Sidenav=i).id=i.$el.attr("id"),i.options=s.extend({},n.defaults,t),i.isOpen=!1,i.isFixed=i.el.classList.contains("sidenav-fixed"),i.isDragged=!1,i.lastWindowWidth=window.innerWidth,i.lastWindowHeight=window.innerHeight,i._createOverlay(),i._createDragTarget(),i._setupEventHandlers(),i._setupClasses(),i._setupFixed(),n._sidenavs.push(i),i}return _inherits(n,Component),_createClass(n,[{key:"destroy",value:function(){this._removeEventHandlers(),this._overlay.parentNode.removeChild(this._overlay),this.dragTarget.parentNode.removeChild(this.dragTarget),this.el.M_Sidenav=void 0;var e=n._sidenavs.indexOf(this);0<=e&&n._sidenavs.splice(e,1)}},{key:"_createOverlay",value:function(){var e=document.createElement("div");this._closeBound=this.close.bind(this),e.classList.add("sidenav-overlay"),e.addEventListener("click",this._closeBound),document.body.appendChild(e),this._overlay=e}},{key:"_setupEventHandlers",value:function(){0===n._sidenavs.length&&document.body.addEventListener("click",this._handleTriggerClick),this._handleDragTargetDragBound=this._handleDragTargetDrag.bind(this),this._handleDragTargetReleaseBound=this._handleDragTargetRelease.bind(this),this._handleCloseDragBound=this._handleCloseDrag.bind(this),this._handleCloseReleaseBound=this._handleCloseRelease.bind(this),this._handleCloseTriggerClickBound=this._handleCloseTriggerClick.bind(this),this.dragTarget.addEventListener("touchmove",this._handleDragTargetDragBound),this.dragTarget.addEventListener("touchend",this._handleDragTargetReleaseBound),this._overlay.addEventListener("touchmove",this._handleCloseDragBound),this._overlay.addEventListener("touchend",this._handleCloseReleaseBound),this.el.addEventListener("touchmove",this._handleCloseDragBound),this.el.addEventListener("touchend",this._handleCloseReleaseBound),this.el.addEventListener("click",this._handleCloseTriggerClickBound),this.isFixed&&(this._handleWindowResizeBound=this._handleWindowResize.bind(this),window.addEventListener("resize",this._handleWindowResizeBound))}},{key:"_removeEventHandlers",value:function(){1===n._sidenavs.length&&document.body.removeEventListener("click",this._handleTriggerClick),this.dragTarget.removeEventListener("touchmove",this._handleDragTargetDragBound),this.dragTarget.removeEventListener("touchend",this._handleDragTargetReleaseBound),this._overlay.removeEventListener("touchmove",this._handleCloseDragBound),this._overlay.removeEventListener("touchend",this._handleCloseReleaseBound),this.el.removeEventListener("touchmove",this._handleCloseDragBound),this.el.removeEventListener("touchend",this._handleCloseReleaseBound),this.el.removeEventListener("click",this._handleCloseTriggerClickBound),this.isFixed&&window.removeEventListener("resize",this._handleWindowResizeBound)}},{key:"_handleTriggerClick",value:function(e){var t=s(e.target).closest(".sidenav-trigger");if(e.target&&t.length){var i=M.getIdFromTrigger(t[0]),n=document.getElementById(i).M_Sidenav;n&&n.open(t),e.preventDefault()}}},{key:"_startDrag",value:function(e){var t=e.targetTouches[0].clientX;this.isDragged=!0,this._startingXpos=t,this._xPos=this._startingXpos,this._time=Date.now(),this._width=this.el.getBoundingClientRect().width,this._overlay.style.display="block",this._initialScrollTop=this.isOpen?this.el.scrollTop:M.getDocumentScrollTop(),this._verticallyScrolling=!1,a.remove(this.el),a.remove(this._overlay)}},{key:"_dragMoveUpdate",value:function(e){var t=e.targetTouches[0].clientX,i=this.isOpen?this.el.scrollTop:M.getDocumentScrollTop();this.deltaX=Math.abs(this._xPos-t),this._xPos=t,this.velocityX=this.deltaX/(Date.now()-this._time),this._time=Date.now(),this._initialScrollTop!==i&&(this._verticallyScrolling=!0)}},{key:"_handleDragTargetDrag",value:function(e){if(this.options.draggable&&!this._isCurrentlyFixed()&&!this._verticallyScrolling){this.isDragged||this._startDrag(e),this._dragMoveUpdate(e);var t=this._xPos-this._startingXpos,i=0<t?"right":"left";t=Math.min(this._width,Math.abs(t)),this.options.edge===i&&(t=0);var n=t,s="translateX(-100%)";"right"===this.options.edge&&(s="translateX(100%)",n=-n),this.percentOpen=Math.min(1,t/this._width),this.el.style.transform=s+" translateX("+n+"px)",this._overlay.style.opacity=this.percentOpen}}},{key:"_handleDragTargetRelease",value:function(){this.isDragged&&(.5<this.percentOpen?this.open():this._animateOut(),this.isDragged=!1,this._verticallyScrolling=!1)}},{key:"_handleCloseDrag",value:function(e){if(this.isOpen){if(!this.options.draggable||this._isCurrentlyFixed()||this._verticallyScrolling)return;this.isDragged||this._startDrag(e),this._dragMoveUpdate(e);var t=this._xPos-this._startingXpos,i=0<t?"right":"left";t=Math.min(this._width,Math.abs(t)),this.options.edge!==i&&(t=0);var n=-t;"right"===this.options.edge&&(n=-n),this.percentOpen=Math.min(1,1-t/this._width),this.el.style.transform="translateX("+n+"px)",this._overlay.style.opacity=this.percentOpen}}},{key:"_handleCloseRelease",value:function(){this.isOpen&&this.isDragged&&(.5<this.percentOpen?this._animateIn():this.close(),this.isDragged=!1,this._verticallyScrolling=!1)}},{key:"_handleCloseTriggerClick",value:function(e){s(e.target).closest(".sidenav-close").length&&!this._isCurrentlyFixed()&&this.close()}},{key:"_handleWindowResize",value:function(){this.lastWindowWidth!==window.innerWidth&&(992<window.innerWidth?this.open():this.close()),this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight}},{key:"_setupClasses",value:function(){"right"===this.options.edge&&(this.el.classList.add("right-aligned"),this.dragTarget.classList.add("right-aligned"))}},{key:"_removeClasses",value:function(){this.el.classList.remove("right-aligned"),this.dragTarget.classList.remove("right-aligned")}},{key:"_setupFixed",value:function(){this._isCurrentlyFixed()&&this.open()}},{key:"_isCurrentlyFixed",value:function(){return this.isFixed&&992<window.innerWidth}},{key:"_createDragTarget",value:function(){var e=document.createElement("div");e.classList.add("drag-target"),document.body.appendChild(e),this.dragTarget=e}},{key:"_preventBodyScrolling",value:function(){document.body.style.overflow="hidden"}},{key:"_enableBodyScrolling",value:function(){document.body.style.overflow=""}},{key:"open",value:function(){!0!==this.isOpen&&(this.isOpen=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this._isCurrentlyFixed()?(a.remove(this.el),a({targets:this.el,translateX:0,duration:0,easing:"easeOutQuad"}),this._enableBodyScrolling(),this._overlay.style.display="none"):(this.options.preventScrolling&&this._preventBodyScrolling(),this.isDragged&&1==this.percentOpen||this._animateIn()))}},{key:"close",value:function(){if(!1!==this.isOpen)if(this.isOpen=!1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this._isCurrentlyFixed()){var e="left"===this.options.edge?"-105%":"105%";this.el.style.transform="translateX("+e+")"}else this._enableBodyScrolling(),this.isDragged&&0==this.percentOpen?this._overlay.style.display="none":this._animateOut()}},{key:"_animateIn",value:function(){this._animateSidenavIn(),this._animateOverlayIn()}},{key:"_animateSidenavIn",value:function(){var e=this,t="left"===this.options.edge?-1:1;this.isDragged&&(t="left"===this.options.edge?t+this.percentOpen:t-this.percentOpen),a.remove(this.el),a({targets:this.el,translateX:[100*t+"%",0],duration:this.options.inDuration,easing:"easeOutQuad",complete:function(){"function"==typeof e.options.onOpenEnd&&e.options.onOpenEnd.call(e,e.el)}})}},{key:"_animateOverlayIn",value:function(){var e=0;this.isDragged?e=this.percentOpen:s(this._overlay).css({display:"block"}),a.remove(this._overlay),a({targets:this._overlay,opacity:[e,1],duration:this.options.inDuration,easing:"easeOutQuad"})}},{key:"_animateOut",value:function(){this._animateSidenavOut(),this._animateOverlayOut()}},{key:"_animateSidenavOut",value:function(){var e=this,t="left"===this.options.edge?-1:1,i=0;this.isDragged&&(i="left"===this.options.edge?t+this.percentOpen:t-this.percentOpen),a.remove(this.el),a({targets:this.el,translateX:[100*i+"%",105*t+"%"],duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){"function"==typeof e.options.onCloseEnd&&e.options.onCloseEnd.call(e,e.el)}})}},{key:"_animateOverlayOut",value:function(){var e=this;a.remove(this._overlay),a({targets:this._overlay,opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){s(e._overlay).css("display","none")}})}}],[{key:"init",value:function(e,t){return _get(n.__proto__||Object.getPrototypeOf(n),"init",this).call(this,this,e,t)}},{key:"getInstance",value:function(e){return(e.jquery?e[0]:e).M_Sidenav}},{key:"defaults",get:function(){return t}}]),n}();e._sidenavs=[],window.M.Sidenav=e,M.jQueryLoaded&&M.initializeJqueryWrapper(e,"sidenav","M_Sidenav")}(cash,M.anime);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpZGVuYXYuanMiXSwibmFtZXMiOlsiJCIsImFuaW0iLCJfZGVmYXVsdHMiLCJlZGdlIiwiZHJhZ2dhYmxlIiwiaW5EdXJhdGlvbiIsIm91dER1cmF0aW9uIiwib25PcGVuU3RhcnQiLCJvbk9wZW5FbmQiLCJvbkNsb3NlU3RhcnQiLCJvbkNsb3NlRW5kIiwicHJldmVudFNjcm9sbGluZyIsIl9Db21wb25lbnQiLCJTaWRlbmF2IiwiZWwiLCJvcHRpb25zIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsIl90aGlzIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJfX3Byb3RvX18iLCJPYmplY3QiLCJnZXRQcm90b3R5cGVPZiIsImNhbGwiLCJNX1NpZGVuYXYiLCJpZCIsIiRlbCIsImF0dHIiLCJleHRlbmQiLCJkZWZhdWx0cyIsImlzT3BlbiIsImlzRml4ZWQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImlzRHJhZ2dlZCIsImxhc3RXaW5kb3dXaWR0aCIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJsYXN0V2luZG93SGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJfY3JlYXRlT3ZlcmxheSIsIl9jcmVhdGVEcmFnVGFyZ2V0IiwiX3NldHVwRXZlbnRIYW5kbGVycyIsIl9zZXR1cENsYXNzZXMiLCJfc2V0dXBGaXhlZCIsIl9zaWRlbmF2cyIsInB1c2giLCJfaW5oZXJpdHMiLCJDb21wb25lbnQiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsIl9yZW1vdmVFdmVudEhhbmRsZXJzIiwiX292ZXJsYXkiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJkcmFnVGFyZ2V0IiwidW5kZWZpbmVkIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiX2Nsb3NlQm91bmQiLCJjbG9zZSIsImJpbmQiLCJvdmVybGF5IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImxlbmd0aCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsIl9oYW5kbGVUcmlnZ2VyQ2xpY2siLCJfaGFuZGxlRHJhZ1RhcmdldERyYWdCb3VuZCIsIl9oYW5kbGVEcmFnVGFyZ2V0RHJhZyIsIl9oYW5kbGVEcmFnVGFyZ2V0UmVsZWFzZUJvdW5kIiwiX2hhbmRsZURyYWdUYXJnZXRSZWxlYXNlIiwiX2hhbmRsZUNsb3NlRHJhZ0JvdW5kIiwiX2hhbmRsZUNsb3NlRHJhZyIsIl9oYW5kbGVDbG9zZVJlbGVhc2VCb3VuZCIsIl9oYW5kbGVDbG9zZVJlbGVhc2UiLCJfaGFuZGxlQ2xvc2VUcmlnZ2VyQ2xpY2siLCJfaGFuZGxlQ2xvc2VUcmlnZ2VyQ2xpY2tCb3VuZCIsIl9oYW5kbGVXaW5kb3dSZXNpemUiLCJfaGFuZGxlV2luZG93UmVzaXplQm91bmQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZSIsIiR0cmlnZ2VyIiwidGFyZ2V0IiwiY2xvc2VzdCIsInNpZGVuYXZJZCIsIk0iLCJnZXRJZEZyb21UcmlnZ2VyIiwic2lkZW5hdkluc3RhbmNlIiwiZ2V0RWxlbWVudEJ5SWQiLCJvcGVuIiwicHJldmVudERlZmF1bHQiLCJjbGllbnRYIiwidGFyZ2V0VG91Y2hlcyIsIl9zdGFydGluZ1hwb3MiLCJfeFBvcyIsIl90aW1lIiwiRGF0ZSIsIm5vdyIsIl93aWR0aCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIndpZHRoIiwic3R5bGUiLCJkaXNwbGF5IiwiX2luaXRpYWxTY3JvbGxUb3AiLCJzY3JvbGxUb3AiLCJnZXREb2N1bWVudFNjcm9sbFRvcCIsIl92ZXJ0aWNhbGx5U2Nyb2xsaW5nIiwicmVtb3ZlIiwiY3VycmVudFNjcm9sbFRvcCIsIk1hdGgiLCJ2ZWxvY2l0eVgiLCJkZWx0YVgiLCJfc3RhcnREcmFnIiwiX2RyYWdNb3ZlVXBkYXRlIiwidG90YWxEZWx0YVgiLCJkcmFnRGlyZWN0aW9uIiwiX2lzQ3VycmVudGx5Rml4ZWQiLCJtaW4iLCJhYnMiLCJ0cmFuc2Zvcm1YIiwidHJhbnNmb3JtUHJlZml4IiwicGVyY2VudE9wZW4iLCJ0cmFuc2Zvcm0iLCJvcGFjaXR5IiwiX2FuaW1hdGVJbiIsIiRjbG9zZVRyaWdnZXIiLCJvdmVyZmxvdyIsInRhcmdldHMiLCJ0cmFuc2xhdGVYIiwiX2VuYWJsZUJvZHlTY3JvbGxpbmciLCJfcHJldmVudEJvZHlTY3JvbGxpbmciLCJlYXNpbmciLCJfYW5pbWF0ZVNpZGVuYXZJbiIsIl9hbmltYXRlT3ZlcmxheUluIiwiX3RoaXMyIiwic2xpZGVPdXRQZXJjZW50IiwiZHVyYXRpb24iLCJjb21wbGV0ZSIsInN0YXJ0IiwiY3NzIiwiX2FuaW1hdGVTaWRlbmF2T3V0IiwiX2FuaW1hdGVPdmVybGF5T3V0IiwiX3RoaXMzIiwiZW5kUGVyY2VudCIsIl90aGlzNCIsIl9nZXQiLCJlbHMiLCJqcXVlcnkiLCJnZXQiLCJqUXVlcnlMb2FkZWQiLCJpbml0aWFsaXplSnF1ZXJ5V3JhcHBlciIsImNhc2giLCJhbmltZSJdLCJtYXBwaW5ncyI6IjRuQ0FBQSxTQUFVQSxFQUFHQyxHQUdYLElBQUlDLEVBQVksQ0FDZEMsS0FBTSxPQUNOQyxXQUFXLEVBQ1hDLFdBQVksSUFDWkMsWUFBYSxJQUNiQyxZQUFhLEtBQ2JDLFVBQVcsS0FDWEMsYUFBYyxLQUNkQyxXQUFZLEtBWGZDLGtCQUFrQixHQU9mTCxFQVBlLFNBQUFNLEdBMEJmLFNBQUFDLEVBQWFDLEVBQUlDLEdBQVNDLGdCQUFBQyxLQUFBSixHQUFBLElBQUFLLEVBQUFDLDJCQUFBRixNQUFBSixFQUFBTyxXQUFBQyxPQUFBQyxlQUFBVCxJQUFBVSxLQUFBTixLQVY1QkosRUFBQUMsRUFBQUMsSUFVNEIsT0FHeEJHLEVBQUtKLEdBQUdVLFVBQVJOLEdBQ0tPLEdBQUtQLEVBQUtRLElBQUlDLEtBQUssTUFjeEJULEVBQUtILFFBQVVmLEVBQUU0QixPQUFPLEdBQUlmLEVBQVFnQixTQUFVZCxHQU05Q0csRUFBS1ksUUFBUyxFQU1kWixFQUFLYSxRQUFVYixFQUFLSixHQUFHa0IsVUFBVUMsU0FBUyxpQkFWMUNmLEVBQUFnQixXQUFBLEVBbUJBaEIsRUFBS2lCLGdCQUFrQkMs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LEdBQ0wsT0FBQW9ILEtBQUExSSxFQUFBTyxXQUFBQyxPQUFBQyxlQUFBVCxHQUFBLE9BQUFJLE1BQUFNLEtBQUFOLEtBQUtxQixLQUFMa0gsRUFBd0JwSCxLQWxFWCxDQUFBYyxJQUFBLGNBQUFDLE1BQUEsU0F3RWJyQyxHQUVBRCxPQWVnQkMsRUFBRzJJLE9BQVMzSSxFQUFHLEdBQUtBLEdBZjVCK0IsWUExRUssQ0FBQUssSUFBQSxXQUFBd0csSUFBQSxXQThEYixPQUFLeEgsTUE5RFFyQixFQUFBLEdBaWhCZEEsRUFBQWdDLFVBQUEsR0FqaEJjVCxPQUFBdUQsRUFBQTlFLFFBQUFBLEVBbWhCTThFLEVBQUFnRSxjQThDckJoRSxFQUFFaUUsd0JBQXdCL0ksRUFBUyxVQUFXLGFBamtCbEQsQ0FzaEJNZ0osS0FBQWxFLEVBQUFtRSIsImZpbGUiOiJzaWRlbmF2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCQsIGFuaW0pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGxldCBfZGVmYXVsdHMgPSB7XG4gICAgZWRnZTogJ2xlZnQnLFxuICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICBpbkR1cmF0aW9uOiAyNTAsXG4gICAgb3V0RHVyYXRpb246IDIwMCxcbiAgICBvbk9wZW5TdGFydDogbnVsbCxcbiAgICBvbk9wZW5FbmQ6IG51bGwsXG4gICAgb25DbG9zZVN0YXJ0OiBudWxsLFxuICAgIG9uQ2xvc2VFbmQ6IG51bGwsXG4gICAgcHJldmVudFNjcm9sbGluZzogdHJ1ZVxuICB9O1xuXG5cbiAgLyoqXG4gICAqIEBjbGFzc1xuICAgKi9cbiAgY2xhc3MgU2lkZW5hdiBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0IFNpZGVuYXYgaW5zdGFuY2UgYW5kIHNldCB1cCBvdmVybGF5XG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICovXG4gICAgY29uc3RydWN0b3IgKGVsLCBvcHRpb25zKSB7XG4gICAgICBzdXBlcihTaWRlbmF2LCBlbCwgb3B0aW9ucyk7XG5cbiAgICAgIHRoaXMuZWwuTV9TaWRlbmF2ID0gdGhpcztcbiAgICAgIHRoaXMuaWQgPSB0aGlzLiRlbC5hdHRyKCdpZCcpO1xuXG4gICAgICAvKipcbiAgICAgICAqIE9wdGlvbnMgZm9yIHRoZSBTaWRlbmF2XG4gICAgICAgKiBAbWVtYmVyIFNpZGVuYXYjb3B0aW9uc1xuICAgICAgICogQHByb3Age1N0cmluZ30gW2VkZ2U9J2xlZnQnXSAtIFNpZGUgb2Ygc2NyZWVuIG9uIHdoaWNoIFNpZGVuYXYgYXBwZWFyc1xuICAgICAgICogQHByb3Age0Jvb2xlYW59IFtkcmFnZ2FibGU9dHJ1ZV0gLSBBbGxvdyBzd2lwZSBnZXN0dXJlcyB0byBvcGVuL2Nsb3NlIFNpZGVuYXZcbiAgICAgICAqIEBwcm9wIHtOdW1iZXJ9IFtpbkR1cmF0aW9uPTI1MF0gLSBMZW5ndGggaW4gbXMgb2YgZW50ZXIgdHJhbnNpdGlvblxuICAgICAgICogQHByb3Age051bWJlcn0gW291dER1cmF0aW9uPTIwMF0gLSBMZW5ndGggaW4gbXMgb2YgZXhpdCB0cmFuc2l0aW9uXG4gICAgICAgKiBAcHJvcCB7RnVuY3Rpb259IG9uT3BlblN0YXJ0IC0gRnVuY3Rpb24gY2FsbGVkIHdoZW4gc2lkZW5hdiBzdGFydHMgZW50ZXJpbmdcbiAgICAgICAqIEBwcm9wIHtGdW5jdGlvbn0gb25PcGVuRW5kIC0gRnVuY3Rpb24gY2FsbGVkIHdoZW4gc2lkZW5hdiBmaW5pc2hlcyBlbnRlcmluZ1xuICAgICAgICogQHByb3Age0Z1bmN0aW9ufSBvbkNsb3NlU3RhcnQgLSBGdW5jdGlvbiBjYWxsZWQgd2hlbiBzaWRlbmF2IHN0YXJ0cyBleGl0aW5nXG4gICAgICAgKiBAcHJvcCB7RnVuY3Rpb259IG9uQ2xvc2VFbmQgLSBGdW5jdGlvbiBjYWxsZWQgd2hlbiBzaWRlbmF2IGZpbmlzaGVzIGV4aXRpbmdcbiAgICAgICAqL1xuICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIFNpZGVuYXYuZGVmYXVsdHMsIG9wdGlvbnMpO1xuXG4gICAgICAvKipcbiAgICAgICAqIERlc2NyaWJlcyBvcGVuL2Nsb3NlIHN0YXRlIG9mIFNpZGVuYXZcbiAgICAgICAqIEB0eXBlIHtCb29sZWFufVxuICAgICAgICovXG4gICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuXG4gICAgICAvKipcbiAgICAgICAqIERlc2NyaWJlcyBpZiBTaWRlbmF2IGlzIGZpeGVkXG4gICAgICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICAgICAqL1xuICAgICAgdGhpcy5pc0ZpeGVkID0gdGhpcy5lbC5jbGFzc0xpc3QuY29udGFpbnMoJ3NpZGVuYXYtZml4ZWQnKTtcblxuICAgICAgLyoqXG4gICAgICAgKiBEZXNjcmliZXMgaWYgU2lkZW5hdiBpcyBiZWluZyBkcmFnZ2VlZFxuICAgICAgICogQHR5cGUge0Jvb2xlYW59XG4gICAgICAgKi9cbiAgICAgIHRoaXMuaXNEcmFnZ2VkID0gZmFsc2U7XG5cbiAgICAgIC8vIFdpbmRvdyBzaXplIHZhcmlhYmxlcyBmb3Igd2luZG93IHJlc2l6ZSBjaGVja3NcbiAgICAgIHRoaXMubGFzdFdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICB0aGlzLmxhc3RXaW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbiAgICAgIHRoaXMuX2NyZWF0ZU92ZXJsYXkoKTtcbiAgICAgIHRoaXMuX2NyZWF0ZURyYWdUYXJnZXQoKTtcbiAgICAgIHRoaXMuX3NldHVwRXZlbnRIYW5kbGVycygpO1xuICAgICAgdGhpcy5fc2V0dXBDbGFzc2VzKCk7XG4gICAgICB0aGlzLl9zZXR1cEZpeGVkKCk7XG5cbiAgICAgIFNpZGVuYXYuX3NpZGVuYXZzLnB1c2godGhpcyk7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldCBkZWZhdWx0cygpIHtcbiAgICAgIHJldHVybiBfZGVmYXVsdHM7XG4gICAgfVxuXG4gICAgc3RhdGljIGluaXQoZWxzLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gc3VwZXIuaW5pdCh0aGlzLCBlbHMsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBJbnN0YW5jZVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRJbnN0YW5jZShlbCkge1xuICAgICAgbGV0IGRvbUVsZW0gPSAhIWVsLmpxdWVyeSA/IGVsWzBdIDogZWw7XG4gICAgICByZXR1cm4gZG9tRWxlbS5NX1NpZGVuYXY7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVhcmRvd24gY29tcG9uZW50XG4gICAgICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50SGFuZGxlcnMoKTtcbiAgICAgIHRoaXMuX292ZXJsYXkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLl9vdmVybGF5KTtcbiAgICAgIHRoaXMuZHJhZ1RhcmdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZHJhZ1RhcmdldCk7XG4gICAgICB0aGlzLmVsLk1fU2lkZW5hdiA9IHVuZGVmaW5lZDtcblxuICAgICAgbGV0IGluZGV4ID0gU2lkZW5hdi5fc2lkZW5hdnMuaW5kZXhPZih0aGlzKTtcbiAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIFNpZGVuYXYuX3NpZGVuYXZzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgX2NyZWF0ZU92ZXJsYXkoKSB7XG4gICAgICBsZXQgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGhpcy5fY2xvc2VCb3VuZCA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcbiAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnc2lkZW5hdi1vdmVybGF5Jyk7XG5cbiAgICAgIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9jbG9zZUJvdW5kKTtcblxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTtcbiAgICAgIHRoaXMuX292ZXJsYXkgPSBvdmVybGF5O1xuICAgIH1cblxuICAgIF9zZXR1cEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgICBpZiAoU2lkZW5hdi5fc2lkZW5hdnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVUcmlnZ2VyQ2xpY2spO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9oYW5kbGVEcmFnVGFyZ2V0RHJhZ0JvdW5kID0gdGhpcy5faGFuZGxlRHJhZ1RhcmdldERyYWcuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuX2hhbmRsZURyYWdUYXJnZXRSZWxlYXNlQm91bmQgPSB0aGlzLl9oYW5kbGVEcmFnVGFyZ2V0UmVsZWFzZS5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5faGFuZGxlQ2xvc2VEcmFnQm91bmQgPSB0aGlzLl9oYW5kbGVDbG9zZURyYWcuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuX2hhbmRsZUNsb3NlUmVsZWFzZUJvdW5kID0gdGhpcy5faGFuZGxlQ2xvc2VSZWxlYXNlLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLl9oYW5kbGVDbG9zZVRyaWdnZXJDbGlja0JvdW5kID0gdGhpcy5faGFuZGxlQ2xvc2VUcmlnZ2VyQ2xpY2suYmluZCh0aGlzKTtcblxuICAgICAgdGhpcy5kcmFnVGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuX2hhbmRsZURyYWdUYXJnZXREcmFnQm91bmQpO1xuICAgICAgdGhpcy5kcmFnVGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5faGFuZGxlRHJhZ1RhcmdldFJlbGVhc2VCb3VuZCk7XG4gICAgICB0aGlzLl9vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuX2hhbmRsZUNsb3NlRHJhZ0JvdW5kKTtcbiAgICAgIHRoaXMuX292ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLl9oYW5kbGVDbG9zZVJlbGVhc2VCb3VuZCk7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuX2hhbmRsZUNsb3NlRHJhZ0JvdW5kKTtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLl9oYW5kbGVDbG9zZVJlbGVhc2VCb3VuZCk7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlQ2xvc2VUcmlnZ2VyQ2xpY2tCb3VuZCk7XG5cblxuICAgICAgLy8gQWRkIHJlc2l6ZSBmb3Igc2lkZSBuYXYgZml4ZWRcbiAgICAgIGlmICh0aGlzLmlzRml4ZWQpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlV2luZG93UmVzaXplQm91bmQgPSB0aGlzLl9oYW5kbGVXaW5kb3dSZXNpemUuYmluZCh0aGlzKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuX2hhbmRsZVdpbmRvd1Jlc2l6ZUJvdW5kKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBfcmVtb3ZlRXZlbnRIYW5kbGVycygpIHtcbiAgICAgIGlmIChTaWRlbmF2Ll9zaWRlbmF2cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZVRyaWdnZXJDbGljayk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZHJhZ1RhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLl9oYW5kbGVEcmFnVGFyZ2V0RHJhZ0JvdW5kKTtcbiAgICAgIHRoaXMuZHJhZ1RhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuX2hhbmRsZURyYWdUYXJnZXRSZWxlYXNlQm91bmQpO1xuICAgICAgdGhpcy5fb3ZlcmxheS5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLl9oYW5kbGVDbG9zZURyYWdCb3VuZCk7XG4gICAgICB0aGlzLl9vdmVybGF5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5faGFuZGxlQ2xvc2VSZWxlYXNlQm91bmQpO1xuICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLl9oYW5kbGVDbG9zZURyYWdCb3VuZCk7XG4gICAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5faGFuZGxlQ2xvc2VSZWxlYXNlQm91bmQpO1xuICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUNsb3NlVHJpZ2dlckNsaWNrQm91bmQpO1xuXG4gICAgICAvLyBSZW1vdmUgcmVzaXplIGZvciBzaWRlIG5hdiBmaXhlZFxuICAgICAgaWYgKHRoaXMuaXNGaXhlZCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5faGFuZGxlV2luZG93UmVzaXplQm91bmQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBUcmlnZ2VyIENsaWNrXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqL1xuICAgIF9oYW5kbGVUcmlnZ2VyQ2xpY2soZSkge1xuICAgICAgbGV0ICR0cmlnZ2VyID0gICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5zaWRlbmF2LXRyaWdnZXInKTtcbiAgICAgIGlmIChlLnRhcmdldCAmJiAkdHJpZ2dlci5sZW5ndGgpIHtcbiAgICAgICAgbGV0IHNpZGVuYXZJZCA9IE0uZ2V0SWRGcm9tVHJpZ2dlcigkdHJpZ2dlclswXSk7XG5cbiAgICAgICAgbGV0IHNpZGVuYXZJbnN0YW5jZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNpZGVuYXZJZCkuTV9TaWRlbmF2O1xuICAgICAgICBpZiAoc2lkZW5hdkluc3RhbmNlKSB7XG4gICAgICAgICAgc2lkZW5hdkluc3RhbmNlLm9wZW4oJHRyaWdnZXIpO1xuICAgICAgICB9XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFNldCB2YXJpYWJsZXMgbmVlZGVkIGF0IHRoZSBiZWdnaW5pbmcgb2YgZHJhZ1xuICAgICAqIGFuZCBzdG9wIGFueSBjdXJyZW50IHRyYW5zaXRpb24uXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqL1xuICAgIF9zdGFydERyYWcoZSkge1xuICAgICAgbGV0IGNsaWVudFggPSBlLnRhcmdldFRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgIHRoaXMuaXNEcmFnZ2VkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3N0YXJ0aW5nWHBvcyA9IGNsaWVudFg7XG4gICAgICB0aGlzLl94UG9zID0gdGhpcy5fc3RhcnRpbmdYcG9zO1xuICAgICAgdGhpcy5fdGltZSA9IERhdGUubm93KCk7XG4gICAgICB0aGlzLl93aWR0aCA9IHRoaXMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICB0aGlzLl9vdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgdGhpcy5faW5pdGlhbFNjcm9sbFRvcCA9IHRoaXMuaXNPcGVuID8gdGhpcy5lbC5zY3JvbGxUb3AgOiBNLmdldERvY3VtZW50U2Nyb2xsVG9wKCk7XG4gICAgICB0aGlzLl92ZXJ0aWNhbGx5U2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICBhbmltLnJlbW92ZSh0aGlzLmVsKTtcbiAgICAgIGFuaW0ucmVtb3ZlKHRoaXMuX292ZXJsYXkpO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogU2V0IHZhcmlhYmxlcyBuZWVkZWQgYXQgZWFjaCBkcmFnIG1vdmUgdXBkYXRlIHRpY2tcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgX2RyYWdNb3ZlVXBkYXRlKGUpIHtcbiAgICAgIGxldCBjbGllbnRYID0gZS50YXJnZXRUb3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICBsZXQgY3VycmVudFNjcm9sbFRvcCA9IHRoaXMuaXNPcGVuID8gdGhpcy5lbC5zY3JvbGxUb3AgOiBNLmdldERvY3VtZW50U2Nyb2xsVG9wKCk7XG4gICAgICB0aGlzLmRlbHRhWCA9IE1hdGguYWJzKHRoaXMuX3hQb3MgLSBjbGllbnRYKTtcbiAgICAgIHRoaXMuX3hQb3MgPSBjbGllbnRYO1xuICAgICAgdGhpcy52ZWxvY2l0eVggPSB0aGlzLmRlbHRhWCAvIChEYXRlLm5vdygpIC0gdGhpcy5fdGltZSk7XG4gICAgICB0aGlzLl90aW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGlmICh0aGlzLl9pbml0aWFsU2Nyb2xsVG9wICE9PSBjdXJyZW50U2Nyb2xsVG9wKSB7XG4gICAgICAgIHRoaXMuX3ZlcnRpY2FsbHlTY3JvbGxpbmcgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyBEcmFnZ2luZyBvZiBTaWRlbmF2XG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqL1xuICAgIF9oYW5kbGVEcmFnVGFyZ2V0RHJhZyhlKSB7XG4gICAgICAvLyBDaGVjayBpZiBkcmFnZ2FibGVcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmRyYWdnYWJsZSB8fCB0aGlzLl9pc0N1cnJlbnRseUZpeGVkKCkgfHwgdGhpcy5fdmVydGljYWxseVNjcm9sbGluZykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIElmIG5vdCBiZWluZyBkcmFnZ2VkLCBzZXQgaW5pdGlhbCBkcmFnIHN0YXJ0IHZhcmlhYmxlc1xuICAgICAgaWYgKCF0aGlzLmlzRHJhZ2dlZCkge1xuICAgICAgICB0aGlzLl9zdGFydERyYWcoZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJ1biB0b3VjaG1vdmUgdXBkYXRlc1xuICAgICAgdGhpcy5fZHJhZ01vdmVVcGRhdGUoZSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSByYXcgZGVsdGFYXG4gICAgICBsZXQgdG90YWxEZWx0YVggPSB0aGlzLl94UG9zIC0gdGhpcy5fc3RhcnRpbmdYcG9zO1xuXG4gICAgICAvLyBkcmFnRGlyZWN0aW9uIGlzIHRoZSBhdHRlbXB0ZWQgdXNlciBkcmFnIGRpcmVjdGlvblxuICAgICAgbGV0IGRyYWdEaXJlY3Rpb24gPSB0b3RhbERlbHRhWCA+IDAgPyAncmlnaHQnIDogJ2xlZnQnO1xuXG4gICAgICAvLyBEb24ndCBhbGxvdyB0b3RhbERlbHRhWCB0byBleGNlZWQgU2lkZW5hdiB3aWR0aCBvciBiZSBkcmFnZ2VkIGluIHRoZSBvcHBvc2l0ZSBkaXJlY3Rpb25cbiAgICAgIHRvdGFsRGVsdGFYID0gTWF0aC5taW4odGhpcy5fd2lkdGgsIE1hdGguYWJzKHRvdGFsRGVsdGFYKSk7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmVkZ2UgPT09IGRyYWdEaXJlY3Rpb24pIHtcbiAgICAgICAgdG90YWxEZWx0YVggPSAwO1xuICAgICAgfVxuXG5cbiAgICAgIC8qKlxuICAgICAgICogdHJhbnNmb3JtWCBpcyB0aGUgZHJhZyBkaXNwbGFjZW1lbnRcbiAgICAgICAqIHRyYW5zZm9ybVByZWZpeCBpcyB0aGUgaW5pdGlhbCB0cmFuc2Zvcm0gcGxhY2VtZW50XG4gICAgICAgKiBJbnZlcnQgdmFsdWVzIGlmIFNpZGVuYXYgaXMgcmlnaHQgZWRnZVxuICAgICAgICovXG4gICAgICBsZXQgdHJhbnNmb3JtWCA9IHRvdGFsRGVsdGFYO1xuICAgICAgbGV0IHRyYW5zZm9ybVByZWZpeCA9ICd0cmFuc2xhdGVYKC0xMDAlKSc7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmVkZ2UgPT09ICdyaWdodCcpIHtcbiAgICAgICAgdHJhbnNmb3JtUHJlZml4ID0gJ3RyYW5zbGF0ZVgoMTAwJSknO1xuICAgICAgICB0cmFuc2Zvcm1YID0gLXRyYW5zZm9ybVg7XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBvcGVuL2Nsb3NlIHBlcmNlbnRhZ2Ugb2Ygc2lkZW5hdiwgd2l0aCBvcGVuID0gMSBhbmQgY2xvc2UgPSAwXG4gICAgICB0aGlzLnBlcmNlbnRPcGVuID0gTWF0aC5taW4oMSwgdG90YWxEZWx0YVggLyB0aGlzLl93aWR0aCk7XG5cbiAgICAgIC8vIFNldCB0cmFuc2Zvcm0gYW5kIG9wYWNpdHkgc3R5bGVzXG4gICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybVByZWZpeH0gdHJhbnNsYXRlWCgke3RyYW5zZm9ybVh9cHgpYDtcbiAgICAgIHRoaXMuX292ZXJsYXkuc3R5bGUub3BhY2l0eSA9IHRoaXMucGVyY2VudE9wZW47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIERyYWcgVGFyZ2V0IFJlbGVhc2VcbiAgICAgKi9cbiAgICBfaGFuZGxlRHJhZ1RhcmdldFJlbGVhc2UoKSB7XG4gICAgICBpZiAodGhpcy5pc0RyYWdnZWQpIHtcbiAgICAgICAgaWYgKHRoaXMucGVyY2VudE9wZW4gPiAuNSkge1xuICAgICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX2FuaW1hdGVPdXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaXNEcmFnZ2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3ZlcnRpY2FsbHlTY3JvbGxpbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgQ2xvc2UgRHJhZ1xuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKi9cbiAgICBfaGFuZGxlQ2xvc2VEcmFnKGUpIHtcbiAgICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgICAvLyBDaGVjayBpZiBkcmFnZ2FibGVcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlIHx8IHRoaXMuX2lzQ3VycmVudGx5Rml4ZWQoKSB8fCB0aGlzLl92ZXJ0aWNhbGx5U2Nyb2xsaW5nKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgbm90IGJlaW5nIGRyYWdnZWQsIHNldCBpbml0aWFsIGRyYWcgc3RhcnQgdmFyaWFibGVzXG4gICAgICAgIGlmICghdGhpcy5pc0RyYWdnZWQpIHtcbiAgICAgICAgICB0aGlzLl9zdGFydERyYWcoZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdW4gdG91Y2htb3ZlIHVwZGF0ZXNcbiAgICAgICAgdGhpcy5fZHJhZ01vdmVVcGRhdGUoZSk7XG5cbiAgICAgICAgLy8gQ2FsY3VsYXRlIHJhdyBkZWx0YVhcbiAgICAgICAgbGV0IHRvdGFsRGVsdGFYID0gdGhpcy5feFBvcyAtIHRoaXMuX3N0YXJ0aW5nWHBvcztcblxuICAgICAgICAvLyBkcmFnRGlyZWN0aW9uIGlzIHRoZSBhdHRlbXB0ZWQgdXNlciBkcmFnIGRpcmVjdGlvblxuICAgICAgICBsZXQgZHJhZ0RpcmVjdGlvbiA9IHRvdGFsRGVsdGFYID4gMCA/ICdyaWdodCcgOiAnbGVmdCc7XG5cbiAgICAgICAgLy8gRG9uJ3QgYWxsb3cgdG90YWxEZWx0YVggdG8gZXhjZWVkIFNpZGVuYXYgd2lkdGggb3IgYmUgZHJhZ2dlZCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uXG4gICAgICAgIHRvdGFsRGVsdGFYID0gTWF0aC5taW4odGhpcy5fd2lkdGgsIE1hdGguYWJzKHRvdGFsRGVsdGFYKSk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZWRnZSAhPT0gZHJhZ0RpcmVjdGlvbikge1xuICAgICAgICAgIHRvdGFsRGVsdGFYID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0cmFuc2Zvcm1YID0gLXRvdGFsRGVsdGFYO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVkZ2UgPT09ICdyaWdodCcpIHtcbiAgICAgICAgICB0cmFuc2Zvcm1YID0gLXRyYW5zZm9ybVg7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYWxjdWxhdGUgb3Blbi9jbG9zZSBwZXJjZW50YWdlIG9mIHNpZGVuYXYsIHdpdGggb3BlbiA9IDEgYW5kIGNsb3NlID0gMFxuICAgICAgICB0aGlzLnBlcmNlbnRPcGVuID0gTWF0aC5taW4oMSwgMSAtIHRvdGFsRGVsdGFYIC8gdGhpcy5fd2lkdGgpO1xuXG4gICAgICAgIC8vIFNldCB0cmFuc2Zvcm0gYW5kIG9wYWNpdHkgc3R5bGVzXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHt0cmFuc2Zvcm1YfXB4KWA7XG4gICAgICAgIHRoaXMuX292ZXJsYXkuc3R5bGUub3BhY2l0eSA9IHRoaXMucGVyY2VudE9wZW47XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIENsb3NlIFJlbGVhc2VcbiAgICAgKi9cbiAgICBfaGFuZGxlQ2xvc2VSZWxlYXNlKCkge1xuICAgICAgaWYgKHRoaXMuaXNPcGVuICYmIHRoaXMuaXNEcmFnZ2VkKSB7XG4gICAgICAgIGlmICh0aGlzLnBlcmNlbnRPcGVuID4gLjUpIHtcbiAgICAgICAgICB0aGlzLl9hbmltYXRlSW4oKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmlzRHJhZ2dlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl92ZXJ0aWNhbGx5U2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGNsb3Npbmcgb2YgU2lkZW5hdiB3aGVuIGVsZW1lbnQgd2l0aCBjbGFzcyAuc2lkZW5hdi1jbG9zZVxuICAgICAqL1xuICAgIF9oYW5kbGVDbG9zZVRyaWdnZXJDbGljayhlKSB7XG4gICAgICBsZXQgJGNsb3NlVHJpZ2dlciA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5zaWRlbmF2LWNsb3NlJyk7XG4gICAgICBpZiAoJGNsb3NlVHJpZ2dlci5sZW5ndGggJiYgIXRoaXMuX2lzQ3VycmVudGx5Rml4ZWQoKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIFdpbmRvdyBSZXNpemVcbiAgICAgKi9cbiAgICBfaGFuZGxlV2luZG93UmVzaXplKCkge1xuICAgICAgLy8gT25seSBoYW5kbGUgaG9yaXpvbnRhbCByZXNpemVzXG4gICAgICBpZiAodGhpcy5sYXN0V2luZG93V2lkdGggIT09IHdpbmRvdy5pbm5lcldpZHRoKSB7XG4gICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+IDk5Mikge1xuICAgICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmxhc3RXaW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgdGhpcy5sYXN0V2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIH1cblxuICAgIF9zZXR1cENsYXNzZXMoKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmVkZ2UgPT09ICdyaWdodCcpIHtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdyaWdodC1hbGlnbmVkJyk7XG4gICAgICAgIHRoaXMuZHJhZ1RhcmdldC5jbGFzc0xpc3QuYWRkKCdyaWdodC1hbGlnbmVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgX3JlbW92ZUNsYXNzZXMoKSB7XG4gICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ3JpZ2h0LWFsaWduZWQnKTtcbiAgICAgIHRoaXMuZHJhZ1RhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdyaWdodC1hbGlnbmVkJyk7XG4gICAgfVxuXG4gICAgX3NldHVwRml4ZWQoKSB7XG4gICAgICBpZiAodGhpcy5faXNDdXJyZW50bHlGaXhlZCgpKSB7XG4gICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF9pc0N1cnJlbnRseUZpeGVkKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNGaXhlZCAmJiB3aW5kb3cuaW5uZXJXaWR0aCA+IDk5MjtcbiAgICB9XG5cbiAgICBfY3JlYXRlRHJhZ1RhcmdldCgpIHtcbiAgICAgIGxldCBkcmFnVGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBkcmFnVGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2RyYWctdGFyZ2V0Jyk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRyYWdUYXJnZXQpO1xuICAgICAgdGhpcy5kcmFnVGFyZ2V0ID0gZHJhZ1RhcmdldDtcbiAgICB9XG5cbiAgICBfcHJldmVudEJvZHlTY3JvbGxpbmcoKSB7XG4gICAgICBsZXQgYm9keSA9IGRvY3VtZW50LmJvZHk7XG4gICAgICBib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgfVxuXG4gICAgX2VuYWJsZUJvZHlTY3JvbGxpbmcoKSB7XG4gICAgICBsZXQgYm9keSA9IGRvY3VtZW50LmJvZHk7XG4gICAgICBib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgIGlmICh0aGlzLmlzT3BlbiA9PT0gdHJ1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcblxuICAgICAgLy8gUnVuIG9uT3BlblN0YXJ0IGNhbGxiYWNrXG4gICAgICBpZiAodHlwZW9mKHRoaXMub3B0aW9ucy5vbk9wZW5TdGFydCkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uT3BlblN0YXJ0LmNhbGwodGhpcywgdGhpcy5lbCk7XG4gICAgICB9XG5cbiAgICAgIC8vIEhhbmRsZSBmaXhlZCBTaWRlbmF2XG4gICAgICBpZiAodGhpcy5faXNDdXJyZW50bHlGaXhlZCgpKSB7XG4gICAgICAgIGFuaW0ucmVtb3ZlKHRoaXMuZWwpO1xuICAgICAgICBhbmltKHtcbiAgICAgICAgICB0YXJnZXRzOiB0aGlzLmVsLFxuICAgICAgICAgIHRyYW5zbGF0ZVg6IDAsXG4gICAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgICAgZWFzaW5nOiAnZWFzZU91dFF1YWQnXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9lbmFibGVCb2R5U2Nyb2xsaW5nKCk7XG4gICAgICAgIHRoaXMuX292ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgLy8gSGFuZGxlIG5vbi1maXhlZCBTaWRlbmF2XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnByZXZlbnRTY3JvbGxpbmcpIHtcbiAgICAgICAgICB0aGlzLl9wcmV2ZW50Qm9keVNjcm9sbGluZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzRHJhZ2dlZCB8fCB0aGlzLnBlcmNlbnRPcGVuICE9IDEpIHtcbiAgICAgICAgICB0aGlzLl9hbmltYXRlSW4oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgaWYgKHRoaXMuaXNPcGVuID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG5cbiAgICAgIC8vIFJ1biBvbkNsb3NlU3RhcnQgY2FsbGJhY2tcbiAgICAgIGlmICh0eXBlb2YodGhpcy5vcHRpb25zLm9uQ2xvc2VTdGFydCkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uQ2xvc2VTdGFydC5jYWxsKHRoaXMsIHRoaXMuZWwpO1xuICAgICAgfVxuXG4gICAgICAvLyBIYW5kbGUgZml4ZWQgU2lkZW5hdlxuICAgICAgaWYgKHRoaXMuX2lzQ3VycmVudGx5Rml4ZWQoKSkge1xuICAgICAgICBsZXQgdHJhbnNmb3JtWCA9IHRoaXMub3B0aW9ucy5lZGdlID09PSAnbGVmdCcgPyAnLTEwNSUnIDogJzEwNSUnO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7dHJhbnNmb3JtWH0pYDtcblxuICAgICAgLy8gSGFuZGxlIG5vbi1maXhlZCBTaWRlbmF2XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9lbmFibGVCb2R5U2Nyb2xsaW5nKCk7XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzRHJhZ2dlZCB8fCB0aGlzLnBlcmNlbnRPcGVuICE9IDApIHtcbiAgICAgICAgICB0aGlzLl9hbmltYXRlT3V0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgX2FuaW1hdGVJbigpIHtcbiAgICAgIHRoaXMuX2FuaW1hdGVTaWRlbmF2SW4oKTtcbiAgICAgIHRoaXMuX2FuaW1hdGVPdmVybGF5SW4oKTtcbiAgICB9XG5cbiAgICBfYW5pbWF0ZVNpZGVuYXZJbigpIHtcbiAgICAgIGxldCBzbGlkZU91dFBlcmNlbnQgPSB0aGlzLm9wdGlvbnMuZWRnZSA9PT0gJ2xlZnQnID8gLTEgOiAxO1xuICAgICAgaWYgKHRoaXMuaXNEcmFnZ2VkKSB7XG4gICAgICAgIHNsaWRlT3V0UGVyY2VudCA9IHRoaXMub3B0aW9ucy5lZGdlID09PSAnbGVmdCcgPyBzbGlkZU91dFBlcmNlbnQgKyB0aGlzLnBlcmNlbnRPcGVuIDogc2xpZGVPdXRQZXJjZW50IC0gdGhpcy5wZXJjZW50T3BlbjtcbiAgICAgIH1cblxuICAgICAgYW5pbS5yZW1vdmUodGhpcy5lbCk7XG4gICAgICBhbmltKHtcbiAgICAgICAgdGFyZ2V0czogdGhpcy5lbCxcbiAgICAgICAgdHJhbnNsYXRlWDogIFtgJHtzbGlkZU91dFBlcmNlbnQgKiAxMDB9JWAsIDBdLFxuICAgICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLmluRHVyYXRpb24sXG4gICAgICAgIGVhc2luZzogJ2Vhc2VPdXRRdWFkJyxcbiAgICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICAvLyBSdW4gb25PcGVuRW5kIGNhbGxiYWNrXG4gICAgICAgICAgaWYgKHR5cGVvZih0aGlzLm9wdGlvbnMub25PcGVuRW5kKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uT3BlbkVuZC5jYWxsKHRoaXMsIHRoaXMuZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2FuaW1hdGVPdmVybGF5SW4oKSB7XG4gICAgICBsZXQgc3RhcnQgPSAwO1xuICAgICAgaWYgKHRoaXMuaXNEcmFnZ2VkKSB7XG4gICAgICAgIHN0YXJ0ID0gdGhpcy5wZXJjZW50T3BlbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQodGhpcy5fb3ZlcmxheSkuY3NzKHtcbiAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBhbmltLnJlbW92ZSh0aGlzLl9vdmVybGF5KTtcbiAgICAgIGFuaW0oe1xuICAgICAgICB0YXJnZXRzOiB0aGlzLl9vdmVybGF5LFxuICAgICAgICBvcGFjaXR5OiBbc3RhcnQsIDFdLFxuICAgICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLmluRHVyYXRpb24sXG4gICAgICAgIGVhc2luZzogJ2Vhc2VPdXRRdWFkJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2FuaW1hdGVPdXQoKSB7XG4gICAgICB0aGlzLl9hbmltYXRlU2lkZW5hdk91dCgpO1xuICAgICAgdGhpcy5fYW5pbWF0ZU92ZXJsYXlPdXQoKTtcbiAgICB9XG5cbiAgICBfYW5pbWF0ZVNpZGVuYXZPdXQoKSB7XG4gICAgICBsZXQgZW5kUGVyY2VudCA9IHRoaXMub3B0aW9ucy5lZGdlID09PSAnbGVmdCcgPyAtMSA6IDE7XG4gICAgICBsZXQgc2xpZGVPdXRQZXJjZW50ID0gMDtcbiAgICAgIGlmICh0aGlzLmlzRHJhZ2dlZCkge1xuICAgICAgICBzbGlkZU91dFBlcmNlbnQgPSB0aGlzLm9wdGlvbnMuZWRnZSA9PT0gJ2xlZnQnID8gZW5kUGVyY2VudCArIHRoaXMucGVyY2VudE9wZW4gOiBlbmRQZXJjZW50IC0gdGhpcy5wZXJjZW50T3BlbjtcbiAgICAgIH1cblxuICAgICAgYW5pbS5yZW1vdmUodGhpcy5lbCk7XG4gICAgICBhbmltKHtcbiAgICAgICAgdGFyZ2V0czogdGhpcy5lbCxcbiAgICAgICAgdHJhbnNsYXRlWDogW2Ake3NsaWRlT3V0UGVyY2VudCAqIDEwMH0lYCwgYCR7ZW5kUGVyY2VudCAqIDEwNX0lYF0sXG4gICAgICAgIGR1cmF0aW9uOiB0aGlzLm9wdGlvbnMub3V0RHVyYXRpb24sXG4gICAgICAgIGVhc2luZzogJ2Vhc2VPdXRRdWFkJyxcbiAgICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICAvLyBSdW4gb25PcGVuRW5kIGNhbGxiYWNrXG4gICAgICAgICAgaWYgKHR5cGVvZih0aGlzLm9wdGlvbnMub25DbG9zZUVuZCkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkNsb3NlRW5kLmNhbGwodGhpcywgdGhpcy5lbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBfYW5pbWF0ZU92ZXJsYXlPdXQoKSB7XG4gICAgICBhbmltLnJlbW92ZSh0aGlzLl9vdmVybGF5KTtcbiAgICAgIGFuaW0oe1xuICAgICAgICB0YXJnZXRzOiB0aGlzLl9vdmVybGF5LFxuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLm91dER1cmF0aW9uLFxuICAgICAgICBlYXNpbmc6ICdlYXNlT3V0UXVhZCcsXG4gICAgICAgIGNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAgICAgJCh0aGlzLl9vdmVybGF5KS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyb2YgU2lkZW5hdlxuICAgKiBAdHlwZSB7QXJyYXkuPFNpZGVuYXY+fVxuICAgKi9cbiAgU2lkZW5hdi5fc2lkZW5hdnMgPSBbXTtcblxuICB3aW5kb3cuTS5TaWRlbmF2ID0gU2lkZW5hdjtcblxuICBpZiAoTS5qUXVlcnlMb2FkZWQpIHtcbiAgICBNLmluaXRpYWxpemVKcXVlcnlXcmFwcGVyKFNpZGVuYXYsICdzaWRlbmF2JywgJ01fU2lkZW5hdicpO1xuICB9XG5cbn0pKGNhc2gsIE0uYW5pbWUpO1xuIl19
